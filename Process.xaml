<Activity mc:Ignorable="sap sap2010" x:Class="ProcessTransaction" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_TransactionItem" Type="InArgument(sd:DataRow)" />
    <x:Property Name="in_Config" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
    <x:Property Name="in_Query" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
    <x:Property Name="in_ConnStr" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
    <x:Property Name="io_ErrorList" Type="InOutArgument(scg:List(x:String))" />
    <x:Property Name="io_StatusDict" Type="InOutArgument(scg:Dictionary(x:String, x:String))" />
    <x:Property Name="in_ContinueTab" Type="InArgument(x:String)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1280,1193</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>ProcessTransaction_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>Microsoft.VisualStudio.Services.Common</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>System.Data.Entity</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Plugin.Workflow</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <Sequence sap2010:Annotation.AnnotationText="획득한 공사정보에 대해서 KISCON 사이트에 해당 변경 내용을 업데이트하는 메인 워크플로우 &#xA;&#xA;Input&#xA; - in_Config: Dictionary&lt;String, Object&gt; - 설정정보 &#xA; - in_TransactionItem : DataRow - 처리할 공사 정보가 저장된 DatRow &#xA; - in_Query: Dictionary&lt;String, Object&gt; - 질의문 &#xA; - in_ConnStr: Dictionary&lt;String, Object&gt; - DB설정 정보 &#xA; - in_ContinueTab: String - 재시도시 참조할 이전 실행시 완료된 탭 이름 &#xA;&#xA;Input/Output&#xA; - io_ErrorList: List&lt;String&gt; - 오류 메세지 리스트   &#xA; - io_StatusDict: Dictionary&lt;String,String&gt; - 진행상태 정보 기록하는 맵 " DisplayName="ProcessTransaction" sap:VirtualizedContainerService.HintSize="1240,1113" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <Sequence.Variables>
      <Variable x:TypeArguments="x:Boolean" Default="False" Name="IsNewContract" />
      <Variable x:TypeArguments="sd:DataTable" Name="CompanyDT" />
      <Variable x:TypeArguments="sd:DataTable" Name="ReceivedMoneyDT" />
      <Variable x:TypeArguments="sd:DataTable" Name="Subcontracts" />
      <Variable x:TypeArguments="x:Double" Name="ShareRatio" />
      <Variable x:TypeArguments="sd:DataTable" Name="PaymentHistory" />
      <Variable x:TypeArguments="sd:DataTable" Name="PaymentDT" />
      <Variable x:TypeArguments="sd:DataTable" Name="Subcontract2" />
      <Variable x:TypeArguments="s:DateTime" Name="CurTime" />
      <Variable x:TypeArguments="x:String" Name="StatusMsg" />
      <Variable x:TypeArguments="x:String" Name="StatusMsg1" />
      <Variable x:TypeArguments="x:String" Name="StatusMsg2" />
      <Variable x:TypeArguments="x:String" Name="StatusMsg3" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart sap:VirtualizedContainerService.HintSize="1218,666" sap2010:WorkflowViewState.IdRef="Flowchart_1">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
          <av:Point x:Key="ShapeLocation">620,2.5</av:Point>
          <av:Size x:Key="ShapeSize">60,75</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">650,77.5 650,110 320,110</av:PointCollection>
          <x:Double x:Key="Width">1204</x:Double>
          <x:Double x:Key="Height">630</x:Double>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <Flowchart.StartNode>
        <x:Reference>__ReferenceID10</x:Reference>
      </Flowchart.StartNode>
      <FlowDecision x:Name="__ReferenceID9" Condition="[String.IsNullOrEmpty( in_ContinueTab) Or in_ContinueTab = &quot;공사개요&quot; Or in_ContinueTab = &quot;수급업체&quot;]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_1">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <av:Point x:Key="ShapeLocation">179.5,226.5</av:Point>
            <av:Size x:Key="ShapeSize">79,87</av:Size>
            <av:PointCollection x:Key="TrueConnector">179.5,270 100,270 100,404.5</av:PointCollection>
            <av:PointCollection x:Key="FalseConnector">258.5,270 288.5,270 288.5,196.5 409,196.5 409,226.5</av:PointCollection>
            <x:String x:Key="TrueLabel">수급업체</x:String>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <FlowDecision.True>
          <FlowStep x:Name="__ReferenceID4" sap2010:WorkflowViewState.IdRef="FlowStep_1">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <av:Point x:Key="ShapeLocation">0,404.5</av:Point>
                <av:Size x:Key="ShapeSize">200,51</av:Size>
                <av:PointCollection x:Key="ConnectorLocation">200,430 230,430 230,450 240,450</av:PointCollection>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Sequence DisplayName="Sequence - 수급업체 처리" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_19">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Pick DisplayName="Pick - 수급업체 처리 " sap:VirtualizedContainerService.HintSize="750,1359" sap2010:WorkflowViewState.IdRef="Pick_4">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <PickBranch sap:VirtualizedContainerService.HintSize="366,1313" sap2010:WorkflowViewState.IdRef="PickBranch_7">
                  <PickBranch.Trigger>
                    <Sequence DisplayName="Sequence - 수급업체 처리" sap:VirtualizedContainerService.HintSize="336,1055" sap2010:WorkflowViewState.IdRef="Sequence_45">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign DisplayName="Assign - 이전단계 설정" sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_69">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:Object">[in_Config("ContinueTab")]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:Object">["수급업체"]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign DisplayName="Assign - 수급업체 변경 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_70">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[io_StatusDict("TAB_NAME")]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">수급업체</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign DisplayName="Assign - 변경사항 초기화 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_116">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke UpdateContractor workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_40" UnSafe="False" WorkflowFileName="KISCON\UpdateContractor.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <InArgument x:TypeArguments="x:String" x:Key="in_UpdateDate">[in_TransactionItem("수정일").ToString]</InArgument>
                          <InArgument x:TypeArguments="x:String" x:Key="in_ContractAmount">[in_TransactionItem("총도급금액").ToString]</InArgument>
                          <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_ContractDT">[CompanyDT]</OutArgument>
                          <InArgument x:TypeArguments="x:Boolean" x:Key="in_IsNewContract">[IsNewContract]</InArgument>
                          <OutArgument x:TypeArguments="x:String" x:Key="out_StatusMsg">[StatusMsg]</OutArgument>
                        </ui:InvokeWorkflowFile.Arguments>
                      </ui:InvokeWorkflowFile>
                      <ui:Delete ContinueOnError="True" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="Delete_4" Path="[Path.Combine( Environment.CurrentDirectory, &quot;Data\TempCompanies.xlsx&quot;)]" />
                      <ui:WriteRange AddHeaders="True" DataTable="[CompanyDT]" DisplayName="Write Range - 다음작업에 필요 " sap:VirtualizedContainerService.HintSize="314,115" sap2010:WorkflowViewState.IdRef="WriteRange_5" SheetName="Sheet1" StartingCell="A1" WorkbookPath="[Path.Combine( Environment.CurrentDirectory, &quot;Data\TempCompanies.xlsx&quot;)]" />
                      <Assign DisplayName="Assign - 수급인 변경 사항 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_71">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[StatusMsg]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke LogKisconStatus workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_41" UnSafe="False" WorkflowFileName="Custom\LogKisconStatus.xaml">
                        <ui:InvokeWorkflowFile.Arguments>
                          <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("LogKisconStatus").ToString]</InArgument>
                          <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("LogKisconStatus").ToString]</InArgument>
                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Messages">[io_StatusDict]</InArgument>
                        </ui:InvokeWorkflowFile.Arguments>
                      </ui:InvokeWorkflowFile>
                      <Assign DisplayName="Assign - 변경사항 초기화 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_72">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                  </PickBranch.Trigger>
                </PickBranch>
                <PickBranch sap:VirtualizedContainerService.HintSize="230,1313" sap2010:WorkflowViewState.IdRef="PickBranch_8">
                  <PickBranch.Trigger>
                    <Delay DisplayName="Delay - 5분 " Duration="[TimeSpan.FromMinutes ( Integer.Parse( in_Config(&quot;수급업체&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delay_4" />
                  </PickBranch.Trigger>
                  <Throw Exception="[New Exception(string.Format(&quot;수급업체 처리에 {0}분을 넘겨 재시작합니다.&quot;, in_Config(&quot;수급업체&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_4" />
                </PickBranch>
              </Pick>
            </Sequence>
            <FlowStep.Next>
              <FlowStep x:Name="__ReferenceID0" sap2010:WorkflowViewState.IdRef="FlowStep_9">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">240,424.5</av:Point>
                    <av:Size x:Key="ShapeSize">200,51</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">440,450 470,450 470,470 480,470</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <Sequence DisplayName="Sequence - 공사대금수령 " sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_44">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Pick DisplayName="Pick - 공사대금수령 " sap:VirtualizedContainerService.HintSize="1603,2998" sap2010:WorkflowViewState.IdRef="Pick_3">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <PickBranch sap:VirtualizedContainerService.HintSize="1219,2952" sap2010:WorkflowViewState.IdRef="PickBranch_5">
                      <PickBranch.Trigger>
                        <Sequence DisplayName="Sequence - 공사대금수령  처리 " sap:VirtualizedContainerService.HintSize="1189,2694" sap2010:WorkflowViewState.IdRef="Sequence_43">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign DisplayName="Assign - 이전단계 설정" sap:VirtualizedContainerService.HintSize="1167,60" sap2010:WorkflowViewState.IdRef="Assign_63">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:Object">[in_Config("ContinueTab")]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:Object">["공사대금수령"]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign DisplayName="Assign - 공사대금 확인 " sap:VirtualizedContainerService.HintSize="1167,60" sap2010:WorkflowViewState.IdRef="Assign_64">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[io_StatusDict("TAB_NAME")]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">공사대금수령</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign DisplayName="Assign - 변경사항 초기화 " sap:VirtualizedContainerService.HintSize="1167,60" sap2010:WorkflowViewState.IdRef="Assign_117">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke GetReceivedMoney workflow" sap:VirtualizedContainerService.HintSize="1167,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_36" UnSafe="False" WorkflowFileName="Custom\GetReceivedMoney.xaml">
                            <ui:InvokeWorkflowFile.Arguments>
                              <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("GetReceivedMoney").ToString]</InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("GetReceivedMoney").ToString]</InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="in_ProjectCode">[in_TransactionItem("PJT_CD").ToString]</InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="in_ContractSeq">[in_TransactionItem("계약차수").ToString]</InArgument>
                              <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_ReceivedDT">[ReceivedMoneyDT]</OutArgument>
                            </ui:InvokeWorkflowFile.Arguments>
                          </ui:InvokeWorkflowFile>
                          <If Condition="[ReceivedMoneyDT isNot Nothing AndAlso ReceivedMoneyDT.Rows.Count &gt; 0]" DisplayName="If - 수령한 대금이 있은 경우에만 " sap:VirtualizedContainerService.HintSize="1167,1381" sap2010:WorkflowViewState.IdRef="If_34">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <If.Then>
                              <Sequence sap:VirtualizedContainerService.HintSize="1042,1233" sap2010:WorkflowViewState.IdRef="Sequence_39">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If Condition="[CompanyDT Is Nothing]" DisplayName="If - 공사대금부터 시작했다면 " sap:VirtualizedContainerService.HintSize="1020,235" sap2010:WorkflowViewState.IdRef="If_30">
                                  <If.Then>
                                    <ui:ReadRange AddHeaders="True" DataTable="[CompanyDT]" DisplayName="Read Range" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="ReadRange_5" SheetName="Sheet1" WorkbookPath="[Path.Combine( Environment.CurrentDirectory, &quot;Data\TempCompanies.xlsx&quot;)]">
                                      <ui:ReadRange.Range>
                                        <InArgument x:TypeArguments="x:String">
                                          <Literal x:TypeArguments="x:String" Value="" />
                                        </InArgument>
                                      </ui:ReadRange.Range>
                                    </ui:ReadRange>
                                  </If.Then>
                                </If>
                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke UpdateReceivedMoney workflow" sap:VirtualizedContainerService.HintSize="1020,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_37" UnSafe="False" WorkflowFileName="KISCON\UpdateReceivedMoney.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <InArgument x:TypeArguments="sd:DataTable" x:Key="in_CompanyDT">[CompanyDT]</InArgument>
                                    <InArgument x:TypeArguments="sd:DataTable" x:Key="in_ReceivedInfo">[ReceivedMoneyDT]</InArgument>
                                    <OutArgument x:TypeArguments="x:String" x:Key="out_StatusMsg1">[StatusMsg1]</OutArgument>
                                    <OutArgument x:TypeArguments="x:String" x:Key="out_StatusMsg2">[StatusMsg2]</OutArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="in_BaseRefDate">2019-03-01</InArgument>
                                    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_ConnStrDict">[in_ConnStr]</InArgument>
                                    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_QueryDict">[in_Query]</InArgument>
                                    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_ConfigDT">[in_Config]</InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="in_ContractName">[in_TransactionItem("기본계약명").ToString]</InArgument>
                                  </ui:InvokeWorkflowFile.Arguments>
                                </ui:InvokeWorkflowFile>
                                <If Condition="[Not String.IsNullOrEmpty(StatusMsg1)]" DisplayName="If - 기성 및 선급금 입력 여부 " sap:VirtualizedContainerService.HintSize="1020,480" sap2010:WorkflowViewState.IdRef="If_33">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If.Then>
                                    <Sequence sap:VirtualizedContainerService.HintSize="531,332" sap2010:WorkflowViewState.IdRef="Sequence_38">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If Condition="[Not String.IsNullOrEmpty( StatusMsg2)]" sap:VirtualizedContainerService.HintSize="509,208" sap2010:WorkflowViewState.IdRef="If_31">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Assign DisplayName="Assign - 기성/선급금  입력 여부 " sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_65">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[StatusMsg1 + "|" + StatusMsg2]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Then>
                                        <If.Else>
                                          <Assign DisplayName="Assign - 기성 입력 여부 " sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_66">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[StatusMsg1]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Else>
                                      </If>
                                    </Sequence>
                                  </If.Then>
                                  <If.Else>
                                    <If Condition="[Not String.IsNullOrEmpty( StatusMsg2)]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_32">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Assign DisplayName="Assign - 선급금 입력 여부 " sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_67">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[StatusMsg2]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                      </If.Then>
                                    </If>
                                  </If.Else>
                                </If>
                                <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke LogKisconStatus workflow" sap:VirtualizedContainerService.HintSize="1020,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_38" UnSafe="False" WorkflowFileName="Custom\LogKisconStatus.xaml">
                                  <ui:InvokeWorkflowFile.Arguments>
                                    <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("LogKisconStatus").ToString]</InArgument>
                                    <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("LogKisconStatus").ToString]</InArgument>
                                    <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Messages">[io_StatusDict]</InArgument>
                                  </ui:InvokeWorkflowFile.Arguments>
                                </ui:InvokeWorkflowFile>
                                <Assign DisplayName="Assign - 변경사항 초기화 " sap:VirtualizedContainerService.HintSize="1020,60" sap2010:WorkflowViewState.IdRef="Assign_68">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                                  </Assign.Value>
                                </Assign>
                              </Sequence>
                            </If.Then>
                          </If>
                          <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[ReceivedMoneyDT]" DisplayName="For Each Row - 입력한 공사대금에 대해서 갱신 " sap:VirtualizedContainerService.HintSize="1167,722" sap2010:WorkflowViewState.IdRef="ForEachRow_6">
                            <ui:ForEachRow.Body>
                              <ActivityAction x:TypeArguments="sd:DataRow">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,574" sap2010:WorkflowViewState.IdRef="Sequence_42">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="x:Int32" Name="UpdateCount" />
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If Condition="[row(&quot;변경완료&quot;).ToString = &quot;Y&quot;]" DisplayName="If - 변경완료로 표시된 항목에 대해서 " sap:VirtualizedContainerService.HintSize="464,450" sap2010:WorkflowViewState.IdRef="If_35">
                                    <If.Then>
                                      <Sequence sap:VirtualizedContainerService.HintSize="336,302" sap2010:WorkflowViewState.IdRef="Sequence_41">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,51" sap2010:WorkflowViewState.IdRef="CommentOut_8">
                                          <ui:CommentOut.Body>
                                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="336,215" sap2010:WorkflowViewState.IdRef="Sequence_40">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_15" Level="Info" Message="[String.Format(&quot;해당 항목 - 수령일:{0}, 수령금액: {1}, 변경완료:{2}&quot;, row(&quot;수령년월일&quot;).ToString, row(&quot;수령금액&quot;).ToString, row(&quot;변경완료&quot;).ToString)]" />
                                            </Sequence>
                                          </ui:CommentOut.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:CommentOut>
                                        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke UpdateReceivedMoney workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_39" UnSafe="False" WorkflowFileName="Custom\UpdateReceivedMoney.xaml">
                                          <ui:InvokeWorkflowFile.Arguments>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("UpdateReceivedMoney").ToString]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("UpdateReceivedMoney").ToString]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_ProjectCode">[in_TransactionItem("PJT_CD").ToString]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_ContractSeq">[in_TransactionItem("계약차수").ToString]</InArgument>
                                            <OutArgument x:TypeArguments="x:Int32" x:Key="out_Rows">[UpdateCount]</OutArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="in_EvalReqNo">[row("EVAL_REQ_NO").ToString]</InArgument>
                                          </ui:InvokeWorkflowFile.Arguments>
                                        </ui:InvokeWorkflowFile>
                                      </Sequence>
                                    </If.Then>
                                  </If>
                                </Sequence>
                              </ActivityAction>
                            </ui:ForEachRow.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ForEachRow>
                        </Sequence>
                      </PickBranch.Trigger>
                    </PickBranch>
                    <PickBranch sap:VirtualizedContainerService.HintSize="230,2952" sap2010:WorkflowViewState.IdRef="PickBranch_6">
                      <PickBranch.Trigger>
                        <Delay DisplayName="Delay - 10분 " Duration="[TimeSpan.FromMinutes ( Integer.Parse( in_Config(&quot;공사대금수령&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delay_3" />
                      </PickBranch.Trigger>
                      <Throw Exception="[New Exception(string.Format(&quot;공사대금수령 처리에 {0}분을 넘겨 재시작합니다.&quot;,  in_Config(&quot;공사대금수령&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_3" />
                    </PickBranch>
                  </Pick>
                </Sequence>
                <FlowStep.Next>
                  <FlowStep x:Name="__ReferenceID1" sap2010:WorkflowViewState.IdRef="FlowStep_10">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">480,444.5</av:Point>
                        <av:Size x:Key="ShapeSize">200,51</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">680,470 720,470</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Sequence DisplayName="Sequence - 보증금 처리 " sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_46">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Pick DisplayName="Pick - 보증금 처리" sap:VirtualizedContainerService.HintSize="750,1142" sap2010:WorkflowViewState.IdRef="Pick_6">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <PickBranch sap:VirtualizedContainerService.HintSize="366,1096" sap2010:WorkflowViewState.IdRef="PickBranch_11">
                          <PickBranch.Trigger>
                            <Sequence DisplayName="Sequence - 보증금 처리 " sap:VirtualizedContainerService.HintSize="336,838" sap2010:WorkflowViewState.IdRef="Sequence_48">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign DisplayName="Assign - 이전단계 설정" sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_77">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:Object">[in_Config("ContinueTab")]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:Object">["보증금"]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign DisplayName="Assign - 보증금 변경 확인 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_78">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[io_StatusDict("TAB_NAME")]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">보증금</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign DisplayName="Assign - 변경사항 초기화 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_118">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke UpdateGuarantee workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_44" UnSafe="False" WorkflowFileName="KISCON\UpdateGuarantee.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_ContractName">[in_TransactionItem("기본계약명").ToString]</InArgument>
                                  <OutArgument x:TypeArguments="x:String" x:Key="out_StatusMsg">[StatusMsg]</OutArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_GuaranteeValidPeriod">[in_Config("보증서유효기간").ToString]</InArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                              <Assign DisplayName="Assign - 보증서 추가 등록 여부 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_79">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[StatusMsg]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke LogKisconStatus workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_45" UnSafe="False" WorkflowFileName="Custom\LogKisconStatus.xaml">
                                <ui:InvokeWorkflowFile.Arguments>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("LogKisconStatus").ToString]</InArgument>
                                  <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("LogKisconStatus").ToString]</InArgument>
                                  <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Messages">[io_StatusDict]</InArgument>
                                </ui:InvokeWorkflowFile.Arguments>
                              </ui:InvokeWorkflowFile>
                              <Assign DisplayName="Assign - 변경사항 초기화 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_80">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </PickBranch.Trigger>
                        </PickBranch>
                        <PickBranch sap:VirtualizedContainerService.HintSize="230,1096" sap2010:WorkflowViewState.IdRef="PickBranch_12">
                          <PickBranch.Trigger>
                            <Delay DisplayName="Delay - 20분 " Duration="[TimeSpan.FromMinutes( Int32.Parse(in_Config(&quot;보증금&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delay_6" />
                          </PickBranch.Trigger>
                          <Throw Exception="[New Exception(string.Format(&quot;보증금 처리에 {0}분이 걸려서 재시작 합니다.&quot;, in_Config(&quot;보증금&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_6" />
                        </PickBranch>
                      </Pick>
                    </Sequence>
                    <FlowStep.Next>
                      <FlowStep x:Name="__ReferenceID2" sap2010:WorkflowViewState.IdRef="FlowStep_13">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">720,444.5</av:Point>
                            <av:Size x:Key="ShapeSize">200,51</av:Size>
                            <av:PointCollection x:Key="ConnectorLocation">920,470 950,470 950,510 970,510</av:PointCollection>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Sequence DisplayName="Sequence - 하수급인 처리 " sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_59">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Pick DisplayName="Pick - 하수급인 처리 " sap:VirtualizedContainerService.HintSize="750,1695" sap2010:WorkflowViewState.IdRef="Pick_8">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <PickBranch sap:VirtualizedContainerService.HintSize="366,1649" sap2010:WorkflowViewState.IdRef="PickBranch_15">
                              <PickBranch.Trigger>
                                <Sequence DisplayName="Sequence - 하수급인 처리" sap:VirtualizedContainerService.HintSize="336,1391" sap2010:WorkflowViewState.IdRef="Sequence_58">
                                  <Sequence.Variables>
                                    <Variable x:TypeArguments="sd:DataTable" Name="AllSubcontractors" />
                                  </Sequence.Variables>
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign DisplayName="Assign - 이전단계 설정" sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_87">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Object">[in_Config("ContinueTab")]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Object">["하수급인"]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <Assign DisplayName="Assign - 하수급인 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_88">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[io_StatusDict("TAB_NAME")]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">하수급인</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <Assign DisplayName="Assign - 변경사항 초기화 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_119">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke GetSubcontractInfo workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_51" UnSafe="False" WorkflowFileName="Custom\GetSubcontractInfo.xaml">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("GetSubcontractInfo").ToString]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("GetSubcontractInfo").ToString]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="in_ProjectCode">[in_TransactionItem("PJT_CD").ToString]</InArgument>
                                      <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_SubcontractDT">[Subcontracts]</OutArgument>
                                    </ui:InvokeWorkflowFile.Arguments>
                                  </ui:InvokeWorkflowFile>
                                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke GetAllSubcontractInfo workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_52" UnSafe="False" WorkflowFileName="Custom\GetAllSubcontractInfo.xaml">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("GetAllSubcontractInfo").ToString]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("GetAllSubcontractInfo").ToString]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="in_ProjectCode">[in_TransactionItem("PJT_CD").ToString]</InArgument>
                                      <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_SubcontractDT">[AllSubcontractors]</OutArgument>
                                    </ui:InvokeWorkflowFile.Arguments>
                                  </ui:InvokeWorkflowFile>
                                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke UpdateSubcontractInfo workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_53" UnSafe="False" WorkflowFileName="KISCON\UpdateSubcontractInfo.xaml">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <InArgument x:TypeArguments="sd:DataTable" x:Key="in_SubcontractInfo">[Subcontracts]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="in_ContractName">[in_TransactionItem("기본계약명").ToString]</InArgument>
                                      <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_Contracts">[Subcontract2]</OutArgument>
                                      <OutArgument x:TypeArguments="x:String" x:Key="out_StatusMsg1">[StatusMsg1]</OutArgument>
                                      <OutArgument x:TypeArguments="x:String" x:Key="out_StatusMsg2">[StatusMsg2]</OutArgument>
                                      <OutArgument x:TypeArguments="x:String" x:Key="out_SubStatusMsg">[StatusMsg3]</OutArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="in_BaseRefDate">[in_Config("BaseRefDate").ToString]</InArgument>
                                      <InOutArgument x:TypeArguments="scg:List(x:String)" x:Key="io_ErrorList">[io_ErrorList]</InOutArgument>
                                      <InArgument x:TypeArguments="sd:DataTable" x:Key="in_AllSubcontrators">[AllSubcontractors]</InArgument>
                                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_ConnStrDict">[in_ConnStr]</InArgument>
                                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_QueryDict">[in_Query]</InArgument>
                                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_ConfigDict">[in_Config]</InArgument>
                                    </ui:InvokeWorkflowFile.Arguments>
                                  </ui:InvokeWorkflowFile>
                                  <ui:Delete ContinueOnError="True" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="Delete_6" Path="[Path.Combine( Environment.CurrentDirectory, &quot;Data\TempSubCompanies.xlsx&quot;)]" />
                                  <ui:WriteRange AddHeaders="True" DataTable="[Subcontract2]" DisplayName="Write Range - 업체명 및 공종 포함 " sap:VirtualizedContainerService.HintSize="314,115" sap2010:WorkflowViewState.IdRef="WriteRange_7" SheetName="Sheet1" StartingCell="A1" WorkbookPath="[Path.Combine( Environment.CurrentDirectory, &quot;Data\TempSubCompanies.xlsx&quot;)]" />
                                  <If Condition="[Not String.IsNullOrEmpty( StatusMsg1)]" DisplayName="If - 신규 및 변경 체크 " sap:VirtualizedContainerService.HintSize="314,51" sap2010:WorkflowViewState.IdRef="If_42">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <If Condition="[Not String.IsNullOrEmpty( StatusMsg2)]" sap:VirtualizedContainerService.HintSize="509,208" sap2010:WorkflowViewState.IdRef="If_40">
                                        <If.Then>
                                          <Assign DisplayName="Assign - 신규 및 변경 " sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_89">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[StatusMsg1 + "|" + StatusMsg2]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Then>
                                        <If.Else>
                                          <Assign DisplayName="Assign - 신규 " sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_90">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[StatusMsg1]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Else>
                                      </If>
                                    </If.Then>
                                    <If.Else>
                                      <If Condition="[Not String.IsNullOrEmpty( StatusMsg2)]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_41">
                                        <If.Then>
                                          <Assign DisplayName="Assign - 변경" sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_91">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[StatusMsg2]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Then>
                                      </If>
                                    </If.Else>
                                  </If>
                                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke LogKisconStatus workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_54" UnSafe="False" WorkflowFileName="Custom\LogKisconStatus.xaml">
                                    <ui:InvokeWorkflowFile.Arguments>
                                      <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("LogKisconStatus").ToString]</InArgument>
                                      <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("LogKisconStatus").ToString]</InArgument>
                                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Messages">[io_StatusDict]</InArgument>
                                    </ui:InvokeWorkflowFile.Arguments>
                                  </ui:InvokeWorkflowFile>
                                  <Assign DisplayName="Assign - 변경사항 초기화 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_92">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,51" sap2010:WorkflowViewState.IdRef="CommentOut_12">
                                    <ui:CommentOut.Body>
                                      <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="538,175" sap2010:WorkflowViewState.IdRef="Sequence_57">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[Subcontracts]" DisplayName="For Each Row - 갱신한 하수급인 정보에 대해서 " sap:VirtualizedContainerService.HintSize="220,51" sap2010:WorkflowViewState.IdRef="ForEachRow_8">
                                          <ui:ForEachRow.Body>
                                            <ActivityAction x:TypeArguments="sd:DataRow">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,574" sap2010:WorkflowViewState.IdRef="Sequence_56">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="x:Int32" Name="UpdateCount" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[row(&quot;변경완료&quot;).ToString = &quot;Y&quot;]" DisplayName="If - 변경완료로 표시된 항목에 대해서 " sap:VirtualizedContainerService.HintSize="464,450" sap2010:WorkflowViewState.IdRef="If_43">
                                                  <If.Then>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="336,302" sap2010:WorkflowViewState.IdRef="Sequence_55">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="314,51" sap2010:WorkflowViewState.IdRef="CommentOut_11">
                                                        <ui:CommentOut.Body>
                                                          <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="336,215" sap2010:WorkflowViewState.IdRef="Sequence_54">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_17" Level="Info" Message="[String.Format(&quot;해당 항목 - 업체명: {0}  계약체결일: {1}  공사기간: {2}-{3}&quot;, row(&quot;하도급업체명&quot;).ToString, row(&quot;계약체결일&quot;).ToString, row(&quot;공사시작일&quot;).ToString, row(&quot;공사종료일&quot;).ToString)]" />
                                                          </Sequence>
                                                        </ui:CommentOut.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:CommentOut>
                                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke UpdateReceivedMoney workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_55" UnSafe="False" WorkflowFileName="Custom\UpdateSubcontractInfo.xaml">
                                                        <ui:InvokeWorkflowFile.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("UpdateSubcontractInfo").ToString]</InArgument>
                                                          <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("UpdateSubcontractInfo").ToString]</InArgument>
                                                          <InArgument x:TypeArguments="x:String" x:Key="in_ProjectCode">[in_TransactionItem("PJT_CD").ToString]</InArgument>
                                                          <InArgument x:TypeArguments="x:String" x:Key="in_ContractSeq">[row("계약변경차수").ToString.Trim]</InArgument>
                                                          <InArgument x:TypeArguments="x:String" x:Key="in_Brno">[row("사업자등록번호").ToString.Trim]</InArgument>
                                                          <OutArgument x:TypeArguments="x:Int32" x:Key="out_Rows">[UpdateCount]</OutArgument>
                                                        </ui:InvokeWorkflowFile.Arguments>
                                                      </ui:InvokeWorkflowFile>
                                                    </Sequence>
                                                  </If.Then>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:ForEachRow.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ForEachRow>
                                      </Sequence>
                                    </ui:CommentOut.Body>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:CommentOut>
                                </Sequence>
                              </PickBranch.Trigger>
                            </PickBranch>
                            <PickBranch sap:VirtualizedContainerService.HintSize="230,1649" sap2010:WorkflowViewState.IdRef="PickBranch_16">
                              <PickBranch.Trigger>
                                <Delay DisplayName="Delay - 20분 " Duration="[TimeSpan.FromMinutes ( Integer.Parse( in_Config(&quot;하수급인&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delay_8" />
                              </PickBranch.Trigger>
                              <Throw Exception="[New Exception(string.Format(&quot;하수급인 처리에 {0}분이 걸려서 재시작합니다.&quot;,  in_Config(&quot;하수급인&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_8" />
                            </PickBranch>
                          </Pick>
                        </Sequence>
                        <FlowStep.Next>
                          <FlowStep x:Name="__ReferenceID3" sap2010:WorkflowViewState.IdRef="FlowStep_15">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <av:Point x:Key="ShapeLocation">970,484.5</av:Point>
                                <av:Size x:Key="ShapeSize">200,51</av:Size>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <Sequence DisplayName="Sequence - 하도급대금지급 처리 " sap:VirtualizedContainerService.HintSize="1456,2752" sap2010:WorkflowViewState.IdRef="Sequence_70">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Pick DisplayName="Pick - 하도급대금지금 처리" sap:VirtualizedContainerService.HintSize="1434,2628" sap2010:WorkflowViewState.IdRef="Pick_10">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <PickBranch sap:VirtualizedContainerService.HintSize="1050,2582" sap2010:WorkflowViewState.IdRef="PickBranch_19">
                                  <PickBranch.Trigger>
                                    <Sequence DisplayName="Sequence - 하도급대금지급" sap:VirtualizedContainerService.HintSize="1020,2324" sap2010:WorkflowViewState.IdRef="Sequence_69">
                                      <Sequence.Variables>
                                        <Variable x:TypeArguments="x:String" Name="DT" />
                                      </Sequence.Variables>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <Assign DisplayName="Assign - 이전단계 설정" sap:VirtualizedContainerService.HintSize="998,60" sap2010:WorkflowViewState.IdRef="Assign_98">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:Object">[in_Config("ContinueTab")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:Object">["하도급대금지급"]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign DisplayName="Assign - 하수급업체 대금 지급" sap:VirtualizedContainerService.HintSize="998,60" sap2010:WorkflowViewState.IdRef="Assign_99">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[io_StatusDict("TAB_NAME")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">하도급대금지급</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <Assign DisplayName="Assign - 변경사항 초기화 " sap:VirtualizedContainerService.HintSize="998,60" sap2010:WorkflowViewState.IdRef="Assign_120">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke GetSubcontractPayment - 기성 workflow" sap:VirtualizedContainerService.HintSize="998,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_62" UnSafe="False" WorkflowFileName="Custom\GetSubcontractPayment.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("GetSubcontractPayment1").ToString]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("GetSubcontractPayment1").ToString]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_ProjectCode">[in_TransactionItem("PJT_CD").ToString]</InArgument>
                                          <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_PaymentDT">[PaymentHistory]</OutArgument>
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="998,91" sap2010:WorkflowViewState.IdRef="LogMessage_22" Level="Trace" Message="[String.Format(&quot;기성 건수 : {0}&quot;, PaymentHistory.Rows.Count)]" />
                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke GetSubcontractPayment - 선급금 workflow" sap:VirtualizedContainerService.HintSize="998,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_63" UnSafe="False" WorkflowFileName="Custom\GetSubcontractPayment.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("GetSubcontractPayment2").ToString]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("GetSubcontractPayment2").ToString]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_ProjectCode">[in_TransactionItem("PJT_CD").ToString]</InArgument>
                                          <OutArgument x:TypeArguments="sd:DataTable" x:Key="out_PaymentDT">[PaymentDT]</OutArgument>
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                      <ui:MergeDataTable Destination="[PaymentHistory]" DisplayName="Merge Data Table" sap:VirtualizedContainerService.HintSize="998,22" sap2010:WorkflowViewState.IdRef="MergeDataTable_4" MissingSchemaAction="Add" Source="[PaymentDT]" />
                                      <ui:WriteRange AddHeaders="True" DataTable="[PaymentHistory]" DisplayName="Write Range" sap:VirtualizedContainerService.HintSize="998,115" sap2010:WorkflowViewState.IdRef="WriteRange_9" SheetName="Sheet1" StartingCell="A1" WorkbookPath="[Path.Combine( Environment.CurrentDirectory, &quot;Data\TempPayment.xlsx&quot;)]" />
                                      <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="998,91" sap2010:WorkflowViewState.IdRef="LogMessage_23" Level="Trace" Message="[String.Format(&quot;선급건+기성   건수 : {0}&quot;, PaymentHistory.Rows.Count)]" />
                                      <If Condition="[Subcontract2 Is Nothing]" DisplayName="If - 하수급인 정보가 없다면 " sap:VirtualizedContainerService.HintSize="998,235" sap2010:WorkflowViewState.IdRef="If_50">
                                        <If.Then>
                                          <ui:ReadRange AddHeaders="True" DataTable="[Subcontract2]" DisplayName="Read Range - 이전탭 데이터 로딩 " sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="ReadRange_7" SheetName="Sheet1" WorkbookPath="[Path.Combine( Environment.CurrentDirectory, &quot;Data\TempSubCompanies.xlsx&quot;)]">
                                            <ui:ReadRange.Range>
                                              <InArgument x:TypeArguments="x:String">
                                                <Literal x:TypeArguments="x:String" Value="" />
                                              </InArgument>
                                            </ui:ReadRange.Range>
                                          </ui:ReadRange>
                                        </If.Then>
                                      </If>
                                      <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="998,51" sap2010:WorkflowViewState.IdRef="CommentOut_17">
                                        <ui:CommentOut.Body>
                                          <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="336,215" sap2010:WorkflowViewState.IdRef="Sequence_74">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_24" Level="Info" Message="[String.Format(&quot; 처리할 대상 건수 : {0}&quot;, PaymentHistory.Rows.Count)]" />
                                          </Sequence>
                                        </ui:CommentOut.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:CommentOut>
                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke UpdateSubcontractPayment workflow" sap:VirtualizedContainerService.HintSize="998,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_64" UnSafe="False" WorkflowFileName="KISCON\UpdateSubcontractPayment.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <InArgument x:TypeArguments="sd:DataTable" x:Key="in_Payments">[PaymentHistory]</InArgument>
                                          <InArgument x:TypeArguments="sd:DataTable" x:Key="in_Contracts">[Subcontract2]</InArgument>
                                          <OutArgument x:TypeArguments="x:String" x:Key="out_StatusMsg1">[StatusMsg1]</OutArgument>
                                          <OutArgument x:TypeArguments="x:String" x:Key="out_StatusMsg2">[StatusMsg2]</OutArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_BaseRefDate">[in_Config("BaseRefDate").ToString]</InArgument>
                                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_ConnStrDict">[in_ConnStr]</InArgument>
                                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_QueryDict">[in_Query]</InArgument>
                                          <InOutArgument x:TypeArguments="scg:List(x:String)" x:Key="io_ErrorList">[io_ErrorList]</InOutArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_ContractName">[in_TransactionItem("기본계약명").ToString]</InArgument>
                                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_ConfigDict">[in_Config]</InArgument>
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                      <If Condition="[Not String.IsNullOrEmpty( StatusMsg1)]" DisplayName="If - 기성 및 선급금 구분 처리 " sap:VirtualizedContainerService.HintSize="998,356" sap2010:WorkflowViewState.IdRef="If_53">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <If Condition="[Not String.IsNullOrEmpty( StatusMsg2)]" sap:VirtualizedContainerService.HintSize="509,208" sap2010:WorkflowViewState.IdRef="If_51">
                                            <If.Then>
                                              <Assign DisplayName="Assign - 기성 및 선급금 " sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_100">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:String">[StatusMsg2 + "|" + StatusMsg1]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </If.Then>
                                            <If.Else>
                                              <Assign DisplayName="Assign - 기성 " sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_101">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:String">[StatusMsg1]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </If.Else>
                                          </If>
                                        </If.Then>
                                        <If.Else>
                                          <If Condition="[Not String.IsNullOrEmpty( StatusMsg2)]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_52">
                                            <If.Then>
                                              <Assign DisplayName="Assign - 선급금" sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_102">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:String">[StatusMsg2]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                            </If.Then>
                                          </If>
                                        </If.Else>
                                      </If>
                                      <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke LogKisconStatus workflow" sap:VirtualizedContainerService.HintSize="998,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_65" UnSafe="False" WorkflowFileName="Custom\LogKisconStatus.xaml">
                                        <ui:InvokeWorkflowFile.Arguments>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("LogKisconStatus").ToString]</InArgument>
                                          <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("LogKisconStatus").ToString]</InArgument>
                                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Messages">[io_StatusDict]</InArgument>
                                        </ui:InvokeWorkflowFile.Arguments>
                                      </ui:InvokeWorkflowFile>
                                      <Assign DisplayName="Assign - 변경사항 초기화 " sap:VirtualizedContainerService.HintSize="998,60" sap2010:WorkflowViewState.IdRef="Assign_121">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[io_StatusDict("change")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="998,51" sap2010:WorkflowViewState.IdRef="CommentOut_16">
                                        <ui:CommentOut.Body>
                                          <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="874,175" sap2010:WorkflowViewState.IdRef="Sequence_68">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[PaymentHistory]" DisplayName="For Each Row - 입력한 하청업체 공사대금 지급에 대해서 " sap:VirtualizedContainerService.HintSize="272,51" sap2010:WorkflowViewState.IdRef="ForEachRow_10">
                                              <ui:ForEachRow.Body>
                                                <ActivityAction x:TypeArguments="sd:DataRow">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="822,722" sap2010:WorkflowViewState.IdRef="Sequence_67">
                                                    <Sequence.Variables>
                                                      <Variable x:TypeArguments="x:Int32" Name="UpdateCount" />
                                                    </Sequence.Variables>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If Condition="[row(&quot;변경완료&quot;).ToString = &quot;Y&quot;]" DisplayName="If - 변경완료로 표시된 항목에 대해서 " sap:VirtualizedContainerService.HintSize="800,598" sap2010:WorkflowViewState.IdRef="If_55">
                                                      <If.Then>
                                                        <Sequence sap:VirtualizedContainerService.HintSize="675,450" sap2010:WorkflowViewState.IdRef="Sequence_66">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="653,51" sap2010:WorkflowViewState.IdRef="CommentOut_15">
                                                            <ui:CommentOut.Body>
                                                              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="336,215" sap2010:WorkflowViewState.IdRef="Sequence_65">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="314,91" sap2010:WorkflowViewState.IdRef="LogMessage_25" Level="Info" Message="[String.Format(&quot;해당 항목 - 업체명: {0}  지급일: {1}  대금구분: {2}  금액: {3}&quot;, row(&quot;하도급업체명&quot;).ToString, row(&quot;지급일&quot;).ToString, row(&quot;대금구분&quot;).ToString, row(&quot;지급액&quot;).ToString)]" />
                                                              </Sequence>
                                                            </ui:CommentOut.Body>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:CommentOut>
                                                          <If Condition="[row(&quot;대금구분&quot;).ToString = &quot;기성금&quot;]" sap:VirtualizedContainerService.HintSize="653,235" sap2010:WorkflowViewState.IdRef="If_54">
                                                            <If.Then>
                                                              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke UpdateSubcontractPayment1-기성 workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_66" UnSafe="False" WorkflowFileName="Custom\UpdateSubcontractPayment.xaml">
                                                                <ui:InvokeWorkflowFile.Arguments>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("UpdateSubcontractPayment1").ToString]</InArgument>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("UpdateSubcontractPayment1").ToString]</InArgument>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_ProjectCode">[in_TransactionItem("PJT_CD").ToString]</InArgument>
                                                                  <OutArgument x:TypeArguments="x:Int32" x:Key="out_Rows">[UpdateCount]</OutArgument>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_OrdCode">[row("발주번호").ToString]</InArgument>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_PaymentDate">[row("지급일").ToString]</InArgument>
                                                                </ui:InvokeWorkflowFile.Arguments>
                                                              </ui:InvokeWorkflowFile>
                                                            </If.Then>
                                                            <If.Else>
                                                              <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke UpdateSubcontractPayment1-선급금 workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_67" UnSafe="False" WorkflowFileName="Custom\UpdateSubcontractPayment.xaml">
                                                                <ui:InvokeWorkflowFile.Arguments>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("UpdateSubcontractPayment2").ToString]</InArgument>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("UpdateSubcontractPayment2").ToString]</InArgument>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_ProjectCode">[in_TransactionItem("PJT_CD").ToString]</InArgument>
                                                                  <OutArgument x:TypeArguments="x:Int32" x:Key="out_Rows">[UpdateCount]</OutArgument>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_OrdCode">[row("발주번호").ToString]</InArgument>
                                                                  <InArgument x:TypeArguments="x:String" x:Key="in_PaymentDate">[row("지급일").ToString]</InArgument>
                                                                </ui:InvokeWorkflowFile.Arguments>
                                                              </ui:InvokeWorkflowFile>
                                                            </If.Else>
                                                          </If>
                                                        </Sequence>
                                                      </If.Then>
                                                    </If>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:ForEachRow.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:ForEachRow>
                                          </Sequence>
                                        </ui:CommentOut.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:CommentOut>
                                    </Sequence>
                                  </PickBranch.Trigger>
                                </PickBranch>
                                <PickBranch sap:VirtualizedContainerService.HintSize="230,2582" sap2010:WorkflowViewState.IdRef="PickBranch_20">
                                  <PickBranch.Trigger>
                                    <Delay DisplayName="Delay - 5분 " Duration="[TimeSpan.FromMinutes ( Integer.Parse( in_Config(&quot;하도급대금지급&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delay_10" />
                                  </PickBranch.Trigger>
                                  <Throw Exception="[New Exception( string.Format(&quot;하도급대금지급에 {0}분이 걸려서 재시작합니다.&quot;, in_Config(&quot;하도급대금지급&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_10" />
                                </PickBranch>
                              </Pick>
                            </Sequence>
                          </FlowStep>
                        </FlowStep.Next>
                      </FlowStep>
                    </FlowStep.Next>
                  </FlowStep>
                </FlowStep.Next>
              </FlowStep>
            </FlowStep.Next>
          </FlowStep>
        </FlowDecision.True>
        <FlowDecision.False>
          <FlowDecision x:Name="__ReferenceID5" Condition="[in_ContinueTab = &quot;공사대금수령&quot;]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_2" True="{x:Reference __ReferenceID0}">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <av:Point x:Key="ShapeLocation">369.5,226.5</av:Point>
                <av:Size x:Key="ShapeSize">79,87</av:Size>
                <av:PointCollection x:Key="TrueConnector">369.5,270 340,270 340,424.5</av:PointCollection>
                <x:String x:Key="TrueLabel">공사대금수령</x:String>
                <av:PointCollection x:Key="FalseConnector">448.5,270 478.5,270 478.5,196.5 599,196.5 599,226.5</av:PointCollection>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <FlowDecision.False>
              <FlowDecision x:Name="__ReferenceID6" Condition="[in_ContinueTab = &quot;보증금&quot;]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_4" True="{x:Reference __ReferenceID1}">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <av:Point x:Key="ShapeLocation">559.5,226.5</av:Point>
                    <av:Size x:Key="ShapeSize">79,87</av:Size>
                    <av:PointCollection x:Key="TrueConnector">559.5,270 529.5,270 529.5,414.5 580,414.5 580,444.5</av:PointCollection>
                    <x:String x:Key="TrueLabel">보증금</x:String>
                    <av:PointCollection x:Key="FalseConnector">638.5,270 668.5,270 668.5,196.5 789,196.5 789,226.5</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <FlowDecision.False>
                  <FlowDecision x:Name="__ReferenceID7" Condition="[in_ContinueTab = &quot;하수급인&quot;]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_3" True="{x:Reference __ReferenceID2}">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <av:Point x:Key="ShapeLocation">749.5,226.5</av:Point>
                        <av:Size x:Key="ShapeSize">79,87</av:Size>
                        <av:PointCollection x:Key="TrueConnector">749.5,270 730,270 730,414.5 820,414.5 820,444.5</av:PointCollection>
                        <av:PointCollection x:Key="FalseConnector">828.5,270 858.5,270 858.5,186.5 969,186.5 969,216.5</av:PointCollection>
                        <x:String x:Key="TrueLabel">하수급인</x:String>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <FlowDecision.False>
                      <FlowDecision x:Name="__ReferenceID8" Condition="[in_ContinueTab = &quot;하도급대금지급&quot;]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_5" True="{x:Reference __ReferenceID3}">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <av:Point x:Key="ShapeLocation">929.5,216.5</av:Point>
                            <av:Size x:Key="ShapeSize">79,87</av:Size>
                            <av:PointCollection x:Key="TrueConnector">929.5,260 900,260 900,402.5 1070,402.5 1070,484.5</av:PointCollection>
                            <x:String x:Key="TrueLabel">하도급대금지급</x:String>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </FlowDecision>
                    </FlowDecision.False>
                  </FlowDecision>
                </FlowDecision.False>
              </FlowDecision>
            </FlowDecision.False>
          </FlowDecision>
        </FlowDecision.False>
      </FlowDecision>
      <x:Reference>__ReferenceID4</x:Reference>
      <x:Reference>__ReferenceID5</x:Reference>
      <x:Reference>__ReferenceID6</x:Reference>
      <x:Reference>__ReferenceID7</x:Reference>
      <x:Reference>__ReferenceID8</x:Reference>
      <x:Reference>__ReferenceID0</x:Reference>
      <x:Reference>__ReferenceID1</x:Reference>
      <x:Reference>__ReferenceID2</x:Reference>
      <x:Reference>__ReferenceID3</x:Reference>
      <FlowStep x:Name="__ReferenceID10" sap2010:WorkflowViewState.IdRef="FlowStep_17">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">120,84.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">220,135.5 220,226.5</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <Sequence DisplayName="Sequence - 기본/공통 (공사개요)" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_73">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Pick DisplayName="Pick - 기본/공통" sap:VirtualizedContainerService.HintSize="614,364" sap2010:WorkflowViewState.IdRef="Pick_12">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <PickBranch sap:VirtualizedContainerService.HintSize="230,318" sap2010:WorkflowViewState.IdRef="PickBranch_23">
              <PickBranch.Trigger>
                <Sequence DisplayName="Sequence - 기본/공통" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_72">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Assign DisplayName="Assign - 이전단계 설정" sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_115">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:Object">[in_Config("ContinueTab")]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:Object">["공사개요"]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_109">
                    <Assign.To>
                      <OutArgument x:TypeArguments="s:DateTime">[CurTime]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="s:DateTime">[DateTime.Now]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign DisplayName="Assign - PJT_CD 입력 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_110">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[io_StatusDict("PJT_CD")]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[in_TransactionItem("PJT_CD").ToString]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign DisplayName="Assign - 트랜잭션 추가 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_111">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[io_StatusDict("TAB_KEY")]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[DateTIme.Now.Ticks.ToString]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign DisplayName="Assign - STATUS 입력 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_112">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[io_StatusDict("STATUS")]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">정상</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign DisplayName="Assign - MESSAGE 입력 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_113">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[io_StatusDict("MESSAGE")]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[String.Empty]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign DisplayName="Assign - 공사개요 입력 " sap:VirtualizedContainerService.HintSize="314,60" sap2010:WorkflowViewState.IdRef="Assign_114">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[io_StatusDict("TAB_NAME")]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">공사개요</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke 로그인 &amp; 공사개요 workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_70" UnSafe="False" WorkflowFileName="KISCON\OpenAndSelectProject.xaml">
                    <ui:InvokeWorkflowFile.Arguments>
                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Config">[in_Config]</InArgument>
                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_ConnStr">[in_ConnStr]</InArgument>
                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:Object)" x:Key="in_Query">[in_Query]</InArgument>
                      <InArgument x:TypeArguments="sd:DataRow" x:Key="in_TransactionItem">[in_TransactionItem]</InArgument>
                      <OutArgument x:TypeArguments="x:Boolean" x:Key="out_IsNewContract">[IsNewContract]</OutArgument>
                      <InOutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="io_StatusMsg">[io_StatusDict]</InOutArgument>
                    </ui:InvokeWorkflowFile.Arguments>
                  </ui:InvokeWorkflowFile>
                  <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke LogKisconStatus workflow" sap:VirtualizedContainerService.HintSize="314,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_71" UnSafe="False" WorkflowFileName="Custom\LogKisconStatus.xaml">
                    <ui:InvokeWorkflowFile.Arguments>
                      <InArgument x:TypeArguments="x:String" x:Key="in_ConnStr">[in_ConnStr("LogKisconStatus").ToString]</InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="in_Query">[in_Query("LogKisconStatus").ToString]</InArgument>
                      <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="in_Messages">[io_StatusDict]</InArgument>
                    </ui:InvokeWorkflowFile.Arguments>
                  </ui:InvokeWorkflowFile>
                </Sequence>
              </PickBranch.Trigger>
            </PickBranch>
            <PickBranch sap:VirtualizedContainerService.HintSize="230,318" sap2010:WorkflowViewState.IdRef="PickBranch_24">
              <PickBranch.Trigger>
                <Delay DisplayName="Delay - 5분 " Duration="[TimeSpan.FromMinutes ( Integer.Parse( in_Config(&quot;공사개요&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delay_12" />
              </PickBranch.Trigger>
              <Throw Exception="[New Exception(string.Format(&quot;공사개요 처리에 {0}분이 걸려서 재시작 합니다.&quot;, in_Config(&quot;공사개요&quot;).ToString))]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_12" />
            </PickBranch>
          </Pick>
        </Sequence>
        <FlowStep.Next>
          <x:Reference>__ReferenceID9</x:Reference>
        </FlowStep.Next>
      </FlowStep>
    </Flowchart>
    <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="1218,91" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Info" Message="[String.Format(&quot; {0} - 변경사항 입력 소요 시간 : {1}&quot;,  in_TransactionItem(&quot;기본계약명&quot;).ToString,  DateTime.Now - CurTime)]" />
  </Sequence>
</Activity>